{% extends "base.html" %}
{% load showcase_extras %}

{% comment %}
Don't forget about how base.html is composed to work with this.
For each component of the storyboard_list, we want to generate a Bootstrap card, I think.
{% endcomment %}

{% block title %}Storyboard{% endblock %}


{% block head %}
    {% if storyboard.gallery %}
        <link rel="stylesheet" src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.0.0/ekko-lightbox.min.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.0.0/ekko-lightbox.min.js"></script>
    {% endif %}
{% endblock %}

{% block content %}
    <div class="opening-banner" style="background-image: url(//assets.ppy.sh//beatmaps/{{ storyboard.set_id }}/covers/cover.jpg);"></div>
    <h1 class="special-banner-2 top-header">{{ storyboard }}</h1>

    <h2 class="special-banner-sub-2 rounded">Overview</h2>

    <div class="container-fluid">
        <div class="card sb-card col-xs-12 col-sm-4">
            <div class="media">
                <div class="media-left media-middle">
                    <img class="media-object rounded" src="//b.ppy.sh/thumb/{{ storyboard.set_id }}l.jpg" alt="{{ s.song }}"/>
                </div>
                <div class="media-body">
                    <p>Storyboarder:<br><a href="/showcase/author/{{ storyboard.storyboarder.pk }}">{{ storyboard.storyboarder }}</a>
                    <br>Mapper:<br>{{ storyboard.mapper }}</p>
                    <p>Developed in {{ storyboard.medium }}.</p>
                </div>
            </div>
        </div>

        <div class="col-xs-12 col-sm-8">
            <p>{{ storyboard.description }}</p>
            {% if storyboard.video %}<a href="{{ storyboard.video }}" class="btn btn-info">Video</a>{% endif %}
            {% if storyboard.set_id %}<a href="//osu.ppy.sh/s/{{ storyboard.set_id }}" class="btn btn-primary">Download!</a>{% endif %}
        </div>
    </div>

    {% if storyboard.gallery %}
        <h2 class="special-banner-sub-2 rounded">Screenshots</h2>
        <p>
            <div class="row">
                {% for photo in storyboard.gallery.public %}
                    <a class="col-sm-4" href="{{ photo.get_sb_screenshot_url }}" data-toggle="lightbox" data-gallery="screenshots">
                        <img class="img-fluid rounded mx-auto d-block" src="{{ photo.get_thumbnail_url }}" class="thumbnail" alt="{{ photo.title }}">
                    </a>
                {% endfor %}
            </div>
        </p>
    {% endif %}

    {% if storyboard.comments %}
    <h2 class="special-banner-sub-2 rounded">{{ storyboard.storyboarder }}'s Comments</h2>
    <div class="media">
        <img class="media-left float-xs-left" src="{{ storyboard.storyboarder.avatar.url }}" style="max-height:128px;"/>
        <div class="media-body">
            <p>{{ storyboard.comments }}</p>
        </div>
    </div>
    {% endif %}

    {% if storyboard.gallery %}
        <script>
            $(document).on('click', '[data-toggle="lightbox"]', function(event) {
                event.preventDefault();
                $(this).ekkoLightbox();
            });
        </script>
    {% endif %}
{% endblock %}